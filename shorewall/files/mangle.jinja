# !!! FILE MANAGED BY SALT !!!
#
# For information about entries in this file, type "man shorewall-mangle"
######################################################################################################################################################################################################
#ACTION         SOURCE          DEST            PROTO   DEST    SOURCE
#                                                       PORT    PORT(S)

{%- for rule in salt['pillar.get']('shorewall:mangle', {}) %}
{# skip if ip version does not match #}
{%-   if rule.ipv is defined and rule.ipv != ipv %}{% continue %}{% endif %}

{%-   if rule is string %}
{{ rule }}
{%-   else %}
# {{ rule.get('comment', '') }}
{{ rule.get('action') }}  {{ rule.get('source', 'none') }}  {{ rule.get('dest', 'none') }}  {{ rule.get('proto', '-') }}  {{ rule.get('destport', '-') }}  {{ rule.get('sourceport', '-') }}  {{ rule.get('user', '-') }}  {{ rule.get('test', '-') }}  {{ rule.get('tos', '-') }}  {{ rule.get('connbytes', '-') }}  {{ rule.get('helper', '-') }}  {{ rule.get('probability', '-') }}  {{ rule.get('dscp', '-') }}  {{ rule.get('state', '-') }}
{%- endif %}
{%- endfor %}
